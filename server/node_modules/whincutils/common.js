
var crypto		= require('crypto');

var bunyan		= require('bunyan')
var log			= bunyan.createLogger({
    name: "Common",
    level: 'debug'
});
var Common		= {
    hash: function (str) {
	return crypto.createHash('sha512').update(str).digest('hex');
    },
    json: function(d,f) {
	return JSON.stringify(d, null, f!==false?4:null);
    },
    serverError: function(resp) {
	return function(err) {
	    log.error(err);
	    if (typeof resp === 'function')
		resp({
		    "error": "Internal Server Error",
		    "message": "Something broke!!  Sucks to be you..."
		});
	}
    },
    del: function(table, column) {
	return function(args, resp) {
	    var id		= args[0];
	    this.args.db(table)
		.where(column, id)
		.del().then(function(affected) {
		    resp({
			"status": affected === 1,
			"affected": affected
		    });
		}, Common.serverError(resp));
	}
    }
};
module.exports = Common;
